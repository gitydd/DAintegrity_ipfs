<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Verify Mortgage - Crowd Bank</title>
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
    <!-- Custom fonts for this template -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700,300italic,400italic,700italic" rel="stylesheet" type="text/css">
  </head>

  <body>

    <!-- Navbar -->
    <nav class="navbar navbar-inverse bg-inverse">
      <a class="navbar-brand text-white" href="/">
        Crowd Bank
      </a>
    </nav>

    <!-- Header -->
    <header class="intro-header">
      <div class="container">
        <div class="intro-message text-center" style="margin-top:10px;">
          <h2>Welcome to Crowd Bank - Central Mortgage Verification System</h2>
          <!--<h4></h4>-->
          <hr class="intro-divider">
          <div class="row text-center">
            <div class="col-sm-3"></div>
            <div class="col-sm-6">
              <input type="text" class="form-control" id="file-hash" name="hash" placeholder="Hash of File to verify" value="">
           
              <input type="button" value="Verify Now"  onclick="verifyData()" >
            </div>
          </div>
          <hr class="intro-divider">
          <input type="text" class="form-control" id="verify-result"  placeholder="The result of File verify" value="">


          <hr class="intro-divider">
          

        </div>
      </div>
    </header>
  </body>
<!-- <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"></script> -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.10.0/js/md5.js"></script>
<script src="https://cdn.datatables.net/1.10.16/js/jquery.dataTables.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.0.108/pdf.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
 
  <script src="//unpkg.com/crypto-js/crypto-js.js"></script>
  <script src="/jquery-3.1.1.min.js"></script>
  <script src="/jquery.cookie.js"></script>  
  <script src="/popper.min.js"></script>
  <script src="/bootstrap.min.js"></script>


<script type="text/javascript">
  
  // Import libraries we need.
import { default as Web3} from 'web3';
import { default as contract } from 'truffle-contract';

import bank_artifacts from './Integrity.json';

var Integrity = contract(bank_artifacts);
var account;
var wtoE;
var GAS_AMOUNT = 90000000;
var SHA256 = require('crypto-js/sha256');
var root1="0x7e3266cd5aadb9e8c4a26abec162b7c8b0c85104438b5b89a5036043763b8472";
/*var root1="0xcd6c890d9318bc690f59b26c30b13db9dcdf082f38c42389481ba1ae52655455";
*/
window.verifyData = function() {
  
    var predigest = $('#file-hash').val();
    console.log(predigest);
    var digest = '0x'.concat(SHA256(predigest));
    console.log(digest);
    console.log(root1);
    console.log(digest == root1);
    Integrity.deployed().then(function(contractInstance) {
        contractInstance.compare.call(digest, root1).then(function(result) {
            console.log(result.valueOf());
            if (result.valueOf() == 2) {
                $('#verify-result').val("False!");
            } else {
                $('#verify-result').val("True!");
            }
        });
    });
}

$( document ).ready(function() {
  if (typeof web3 !== 'undefined') {
    console.warn("Using web3 detected from external source. If you find that your accounts don't appear or you have 0 MetaCoin, ensure you've configured that source properly. If using MetaMask, see the following link. Feel free to delete this warning. :) http://truffleframework.com/tutorials/truffle-and-metamask")
    // Use Mist/MetaMask's provider
    window.web3 = new Web3(web3.currentProvider);
  } else {
    console.warn("No web3 detected. Falling back to http://localhost:8545. You should remove this fallback when you deploy live, as it's inherently insecure. Consider switching to Metamask for development. More info here: http://truffleframework.com/tutorials/truffle-and-metamask");
    // fallback - use your fallback strategy (local node / hosted node + in-dapp id mgmt / fail)
    window.web3 = new Web3(new Web3.providers.HttpProvider("http://localhost:8545"));
  }
  web3.eth.getAccounts(function(err, accs) {
    account = accs[0];
    wtoE = web3.toWei(1,'ether');
  });

  Integrity.setProvider(web3.currentProvider);
});
  
</script>>




<script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/3.1.9-1/crypto-js.min.js"></script>
</html>